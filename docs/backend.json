{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile and personal information for resume generation.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "User's phone number."
        },
        "address": {
          "type": "string",
          "description": "User's street address."
        },
        "city": {
          "type": "string",
          "description": "User's city."
        },
        "state": {
          "type": "string",
          "description": "User's state."
        },
        "zipCode": {
          "type": "string",
          "description": "User's zip code."
        },
        "linkedinUrl": {
          "type": "string",
          "description": "User's LinkedIn profile URL.",
          "format": "uri"
        },
        "githubUrl": {
          "type": "string",
          "description": "User's GitHub profile URL.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email"
      ]
    },
    "Resume": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resume",
      "type": "object",
      "description": "Represents a resume uploaded or generated by the user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resume."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Resume)"
        },
        "originalFileName": {
          "type": "string",
          "description": "The original file name of the uploaded resume."
        },
        "fileType": {
          "type": "string",
          "description": "The file type of the resume (e.g., PDF, DOC, HTML)."
        },
        "uploadDate": {
          "type": "string",
          "description": "The date and time when the resume was uploaded.",
          "format": "date-time"
        },
        "content": {
          "type": "string",
          "description": "The content of the resume (e.g., text from the PDF, DOC, or HTML)."
        }
      },
      "required": [
        "id",
        "userId",
        "originalFileName",
        "fileType",
        "uploadDate",
        "content"
      ]
    },
    "JobDescription": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JobDescription",
      "type": "object",
      "description": "Represents a job description uploaded by the user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the job description."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N JobDescription)"
        },
        "originalFileName": {
          "type": "string",
          "description": "The original file name of the uploaded job description."
        },
        "fileType": {
          "type": "string",
          "description": "The file type of the job description (e.g., PDF, DOC, HTML)."
        },
        "uploadDate": {
          "type": "string",
          "description": "The date and time when the job description was uploaded.",
          "format": "date-time"
        },
        "content": {
          "type": "string",
          "description": "The content of the job description (e.g., text from the PDF, DOC, or HTML)."
        }
      },
      "required": [
        "id",
        "userId",
        "originalFileName",
        "fileType",
        "uploadDate",
        "content"
      ]
    },
    "ResumeAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResumeAnalysis",
      "type": "object",
      "description": "Represents the analysis results of a resume against a job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resume analysis."
        },
        "resumeId": {
          "type": "string",
          "description": "Reference to Resume. (Relationship: Resume 1:N ResumeAnalysis)"
        },
        "jobDescriptionId": {
          "type": "string",
          "description": "Reference to JobDescription. (Relationship: JobDescription 1:N ResumeAnalysis)"
        },
        "suitabilityScore": {
          "type": "number",
          "description": "A score representing how well the resume matches the job description."
        },
        "matchedKeywords": {
          "type": "array",
          "description": "A list of keywords found in both the resume and job description.",
          "items": {
            "type": "string"
          }
        },
        "missingKeywords": {
          "type": "array",
          "description": "A list of keywords present in the job description but missing from the resume.",
          "items": {
            "type": "string"
          }
        },
        "analysisDate": {
          "type": "string",
          "description": "The date and time when the analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "resumeId",
        "jobDescriptionId",
        "suitabilityScore",
        "analysisDate"
      ]
    },
    "GeneratedResume": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "GeneratedResume",
      "type": "object",
      "description": "Represents a resume generated based on the analysis of a resume and job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the generated resume."
        },
        "resumeAnalysisId": {
          "type": "string",
          "description": "Reference to ResumeAnalysis. (Relationship: ResumeAnalysis 1:N GeneratedResume)"
        },
        "content": {
          "type": "string",
          "description": "The content of the generated resume."
        },
        "generationDate": {
          "type": "string",
          "description": "The date and time when the resume was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "resumeAnalysisId",
        "content",
        "generationDate"
      ]
    },
    "CoverLetter": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CoverLetter",
      "type": "object",
      "description": "Represents a cover letter generated for a specific job application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the cover letter."
        },
        "generatedResumeId": {
          "type": "string",
          "description": "Reference to GeneratedResume. (Relationship: GeneratedResume 1:N CoverLetter)"
        },
        "content": {
          "type": "string",
          "description": "The content of the generated cover letter."
        },
        "generationDate": {
          "type": "string",
          "description": "The date and time when the cover letter was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "generatedResumeId",
        "content",
        "generationDate"
      ]
    },
    "FollowUpEmail": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FollowUpEmail",
      "type": "object",
      "description": "Represents a follow-up email generated for a specific job application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the follow-up email."
        },
        "coverLetterId": {
          "type": "string",
          "description": "Reference to CoverLetter. (Relationship: CoverLetter 1:N FollowUpEmail)"
        },
        "content": {
          "type": "string",
          "description": "The content of the generated follow-up email."
        },
        "generationDate": {
          "type": "string",
          "description": "The date and time when the follow-up email was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "coverLetterId",
        "content",
        "generationDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information.  Each user has their own document. Includes denormalized user ID for authorization.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumes/{resumeId}",
        "definition": {
          "entityName": "Resume",
          "schema": {
            "$ref": "#/backend/entities/Resume"
          },
          "description": "Stores resumes uploaded or created by the user. (UserProfile 1:N Resume)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "resumeId",
              "description": "The unique identifier for the resume."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/jobDescriptions/{jobDescriptionId}",
        "definition": {
          "entityName": "JobDescription",
          "schema": {
            "$ref": "#/backend/entities/JobDescription"
          },
          "description": "Stores job descriptions uploaded by the user. (UserProfile 1:N JobDescription)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "jobDescriptionId",
              "description": "The unique identifier for the job description."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumeAnalyses/{resumeAnalysisId}",
        "definition": {
          "entityName": "ResumeAnalysis",
          "schema": {
            "$ref": "#/backend/entities/ResumeAnalysis"
          },
          "description": "Stores the results of analyzing a resume against a job description. (Resume 1:N ResumeAnalysis)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "resumeAnalysisId",
              "description": "The unique identifier for the resume analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/generatedResumes/{generatedResumeId}",
        "definition": {
          "entityName": "GeneratedResume",
          "schema": {
            "$ref": "#/backend/entities/GeneratedResume"
          },
          "description": "Stores resumes generated based on a resume analysis. (ResumeAnalysis 1:N GeneratedResume)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "generatedResumeId",
              "description": "The unique identifier for the generated resume."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/coverLetters/{coverLetterId}",
        "definition": {
          "entityName": "CoverLetter",
          "schema": {
            "$ref": "#/backend/entities/CoverLetter"
          },
          "description": "Stores cover letters generated for a specific job application. (GeneratedResume 1:N CoverLetter)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "coverLetterId",
              "description": "The unique identifier for the cover letter."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/followUpEmails/{followUpEmailId}",
        "definition": {
          "entityName": "FollowUpEmail",
          "schema": {
            "$ref": "#/backend/entities/FollowUpEmail"
          },
          "description": "Stores follow-up emails generated for a specific job application. (CoverLetter 1:N FollowUpEmail)",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "followUpEmailId",
              "description": "The unique identifier for the follow-up email."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure data ownership, separation of concerns, and efficient querying. User profiles are stored under `/users/{userId}` for private user data. Resumes, Job Descriptions, Resume Analyses, Generated Resumes, Cover Letters, and Follow-Up Emails are all stored as subcollections of `/users/{userId}` to maintain ownership and isolation. This approach allows for easy querying of all data related to a specific user and avoids the need for complex cross-collection queries. The structure facilitates secure `list` operations because access control is based on user ID, ensuring that users can only access their own data. This structure avoids hierarchical authorization dependencies, as all data is directly linked to the user ID. All documents related to a particular user are nested under that user's ID, eliminating the need for `get()` calls in security rules and enabling atomic operations."
  }
}